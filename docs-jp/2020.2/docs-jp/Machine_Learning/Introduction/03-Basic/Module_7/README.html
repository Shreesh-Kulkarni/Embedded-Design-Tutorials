


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis チュートリアル
          

          
          </a>

          
            
            
              <div class="version">
                2020.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">English version</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">入門</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis/README.html">Vitis フロー 101 チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS の解析および最適化</a></li>
</ul>
<p class="caption"><span class="caption-text">機械学習 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">Introduction to Machine Learning with Vitis AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html#design-tutorials">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">アクセラレーション</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html">Vitis ハードウェア アクセラレータの概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id1">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">AI エンジン開発 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../AI_Engine_Development/README.html">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../AI_Engine_Development/README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">プラットフォーム作成チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Vitis_Platform_Creation/README.html">プラットフォームの作成</a></li>
</ul>
<p class="caption"><span class="caption-text">XRT および Vitis システム最適化</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">バージョン</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/blob/Vitis-Tutorials-2019.2-Hotfix1/README.md">2019.2</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/Machine_Learning/Introduction/03-Basic/Module_7/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis チュートリアル</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>3.7 Acceleration with HLS kernel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/Machine_Learning/Introduction/03-Basic/Module_7/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="acceleration-with-hls-kernel">
<h1>3.7 Acceleration with HLS kernel<a class="headerlink" href="#acceleration-with-hls-kernel" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><em><strong>Version: Vitis 2020.2+Vitis AI 1.3</strong></em></p>
<p><strong><em>Note</em></strong>: You need to use the new image you generated in Section_3-Module_7. After the OS boot succesfully, you can refer to <a class="reference external" href="https://github.com/Xilinx/Vitis-AI/tree/master/demo/Vitis-AI-Library#quick-start-for-edge">quick_start</a> guide to learn how to prepare the development evironment.
This example suite, for the Vitis AI Library and Vitis Accelerated Kernel, shows how to use the Vitis AI Library runs neural networks on DPUs and how to use the HLS kernel to speed up pre/… Postprocessing. About how to immigrate from OpenCV to HLS, please refer to <a class="reference internal" href="app/README.html"><span class="doc">app/README.md</span></a></p>
<p>Some system level functions:</p>
<ul class="simple">
<li><p>working with DRM on ZynqMP</p>
<ul>
<li><p>Using the DRM to display</p></li>
</ul>
</li>
<li><p>V4L2 initialization and control</p>
<ul>
<li><p>Streaming video capture from V4L2, such as USB camera.</p></li>
</ul>
</li>
</ul>
<p>The directory structure and brief explanations as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>├── app
│   ├── include                    <span class="c1">#headers directory of work pipeline</span>
│   │   ├── decodethread.hpp       <span class="c1">#header file of decode thread</span>
│   │   ├── dputhread.hpp          <span class="c1">#header file of dpu threadd</span>
│   │   ├── filter.hpp             <span class="c1">#dpu filer header </span>
│   │   ├── frameinfo.hpp          <span class="c1">#important data structure </span>
│   │   ├── guithread.hpp          <span class="c1">#display thread headerfile</span>
│   │   ├── mythread.hpp           <span class="c1">#thread pool </span>
│   │   └── sortthread.hpp         <span class="c1">#sort thread header</span>
│   ├── README.md                  <span class="c1">#instruction of how to migrate from OpenCV to HLS</span>
│   ├── src                        <span class="c1">#implementation of the work threads</span>
│   │   ├── decodethread.cpp
│   │   ├── dputhread.cpp
│   │   ├── guithread.cpp
│   │   ├── mythread.cpp
│   │   └── sortthread.cpp
│   └── <span class="nb">test</span>
│       └── usb_input_multi_threads_xcl_refinedet.cpp <span class="c1">#main application</span>
├── kernel                            <span class="c1">#HLS kernel work directory</span>
│   ├── build                         <span class="c1">#directory of config file</span>
│   │   ├── dpu_conf.vh               <span class="c1">#dpu IP config file</span>
│   │   ├── Makefile                  <span class="c1">#The Makefile used to replace the file in ${DPU_TRD}</span>
│   │   ├── preprocessor_config.ini   <span class="c1">#config file of pre_processor</span>
│   │   └── prj_config_104_2dpu       <span class="c1">#Config file required be Makefile for IP integration</span>
│   ├── flash_sd_card.sh              <span class="c1">#Script to generate the OS image</span>
│   └── src                           <span class="c1">#HLS kernel source codes directory</span>
│       ├── pre_processor.cpp   
│       └── pre_processor.h
├── my_V4l2s                          <span class="c1"># V4l2 libraries work directory to get image data from USB camera</span>
│   ├── CMakeLists.txt                <span class="c1"># cmake file to build libs</span>
│   ├── include                       
│   │   ├── dpdrm.hpp                 <span class="c1">#Encapsulate drm library</span>
│   │   ├── line_exception.hpp        <span class="c1">#Encapsulate throw error</span>
│   │   ├── V4l2Access.hpp            <span class="c1">#Interface to access the camera device</span>
│   │   ├── V4l2Capture.hpp           <span class="c1">#Methods to get the image</span>
│   │   ├── V4l2Device.hpp            <span class="c1">#Device capablity </span>
│   │   ├── V4l2MmapDevice.hpp        <span class="c1">#Device type</span>
│   │   ├── V4l2Output.hpp            <span class="c1">#asistant class</span>
│   │   ├── V4l2ReadWriteDevice.hpp   <span class="c1">#Device type</span>
│   │   └── xcl2.hpp                  <span class="c1">#Encapsulate the kernel usage</span>
│   ├── src
│   │   ├── V4l2Access.cpp
│   │   ├── V4l2Capture.cpp
│   │   ├── V4l2Device.cpp
│   │   ├── V4l2MmapDevice.cpp
│   │   ├── V4l2Output.cpp
│   │   ├── V4l2ReadWriteDevice.cpp
│   │   └── xcl2.cpp
│   └── <span class="nb">test</span>
│       ├── build.sh                <span class="c1">#compile script</span>
│       ├── test_hls_kernel.cpp     <span class="c1">#test case for hls kernel</span>
│       └── test.yuv                <span class="c1">#test data</span>
└── README.md
└── CMakeLists.txt
└── build_app_arm.sh                <span class="c1"># Build application with hls kernel</span>
└── build_app_hls.sh                <span class="c1"># Build application with arm preprocessing</span>
</pre></div>
</div>
<div class="section" id="pre-requirement">
<h2>Pre-Requirement<a class="headerlink" href="#pre-requirement" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Hardware required:</p>
<ul>
<li><p>ZCU104 evaluation board</p></li>
<li><p>Micro-USB cable, connect to lattop for the terminal emulator.</p></li>
<li><p>SD card to burn the OS image.</p></li>
</ul>
</li>
<li><p>Software required:</p></li>
<li><p>Vitis 2020.2 <a class="reference external" href="https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/vitis/2020-2.html">Vitis Core Development Kit</a> install in server.</p></li>
<li><p><a class="reference external" href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers">Silicon Labs quad CP210x USB-to-UART bridge driver</a> install in laptop.</p></li>
<li><p>Serial terminal emulator e.g. teraterm, Mobaxterm install in laptop</p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/XRT/tree/2020.2">XRT 2020.2</a> install in laptop</p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/Vitis_Embedded_Platform_Source/tree/master/Xilinx_Official_Platforms/xilinx_zcu104_base">zcu104 base platform</a> install in server</p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis-ai-runtime-1.3.0.tar.gz">Vitis AI runtime package</a> base on VAI1.3</p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/Vitis-AI/blob/master/dsa/DPU-TRD/app/dpu_sw_optimize.tar.gz">dpu_sw_optimize.tar.gz</a> Running zynqmp_dpu_optimize.sh to optimize the board setting</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="workflow-overview">
<h2>Workflow Overview<a class="headerlink" href="#workflow-overview" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Step 1: Create Base Platform</p></li>
<li><p>Step 2: DPU and HLS kernel integration</p></li>
<li><p>Step 3: Cross Compiler Environtment Set up and Build application</p></li>
<li><p>Step 4: Board Development Setting</p></li>
<li><p>Step 5: Run the Application.</p></li>
</ul>
</div>
<div class="section" id="step-1-create-base-platform">
<h2>Step 1:Create Base Platform<a class="headerlink" href="#step-1-create-base-platform" title="Permalink to this headline">¶</a></h2>
<p>In this step you can choose build a platform form scratch, the detail tutorial you can refer to <a class="reference internal" href="../../../../Vitis_Platform_Creation/README.html"><span class="doc">Vitis_Platform_Creation</span></a>.</p>
<p>The other way is to use the Official Platofrm code of <a class="reference external" href="https://github.com/Xilinx/Vitis_Embedded_Platform_Source">Xilinx_Official_Platform</a>, in which the platform build process is entirely scripted. Note that as this platform build process involves cross-compiling Linux, build of the platform is supported on Linux environments only (although it is possible to build inside a VM or Docker container).</p>
<p>Also note that the default PetaLinux configuration uses local scratchpad areas. This will not work if you are building on a networked file system; Yocto will error out. Update PetaLinux to change the build area to a locally-mounted hard drive (most Xilinx internal network servers have a /scratch or /tmp area for this purpose).</p>
<p>After cloning the platform source, and with both Vivado and PetaLinux set up, run <em><strong>make</strong></em> from the top-level platform directory. In this case we choose ZCU104_Base platform.</p>
<div class="section" id="step-2-dpu-and-hls-kernel-integration">
<h3>Step 2:  DPU and HLS kernel integration<a class="headerlink" href="#step-2-dpu-and-hls-kernel-integration" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Clone the repository of Vitis-AI and vitis_library, the preprocessor kernel implements base on vitis_library, Befor you build the haredware design, you need to clone the vitis_library under the <em><strong>${DPU-TRD}/prj/Vitis</strong></em> directory.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/Xilinx/Vitis-AI.git
$ cd Vitis-AI/dsa/DPU-TRD/prj/Vitis/
$ git clone https://github.com/Xilinx/Vitis_Libraries.git

</pre></div>
</div>
<ul class="simple">
<li><p>download the <a class="reference external" href="https://www.xilinx.com/member/forms/download/xef.html?filename=xilinx-zynqmp-common-v2020.2.tar.gz">mpsoc common system</a>, and unzip the files.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tar -xvzf  xilinx-zynqmp-common-v2020.2.tar.gz
$ cd xilinx-zynqmp-common-v2020.2
$ gzip -d rootfs.ext4.gz
</pre></div>
</div>
<ul class="simple">
<li><p>copy the kernel source code and config files below to DPU-TRD work directory</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cp ${Module_7}/kernel/build/Makefile Vitis-AI/dsa/DPU-TRD/prj/Vitis
$ cp ${Module_7}/kernel/build/preprocessor_config.ini Vitis-AI/dsa/DPU-TRD/prj/Vitis
$ cp ${Module_7}/kernel/build/dpu_conf.vh Vitis-AI/dsa/DPU-TRD/prj/Vitis
$ cp ${Module_7}/kernel/src/pre_processor.cpp Vitis-AI/dsa/DPU-TRD/prj/Vitis
$ cp ${Module_7}/kernel/src/pre_processor.h Vitis-AI/dsa/DPU-TRD/prj/Vitis
$ cp ${Module_7}/kernel/config_file/prj_config_104_2dpu Vitis-AI/dsa/DPU-TRD/prj/Vitis/config_file
</pre></div>
</div>
<ul class="simple">
<li><p>Step4: Run the below commands to start IP integration and wait for it to complete.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">SDX_PLATFORM</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">platform</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">EDGE_COMMON_SW</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">edge_common_sw</span><span class="o">&gt;</span>
<span class="n">make</span> <span class="n">KERNEL</span><span class="o">=</span><span class="n">DPU</span> <span class="n">DEVICE</span><span class="o">=</span><span class="n">ZCU104</span>
</pre></div>
</div>
<p>There are two methods to set up the target environment</p>
<ol class="simple">
<li><p>Replace the BOOT.BIN and the dpu.xclbin on target.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ scp Vitis-AI/dsa/DPU-TRD/prj/Vitis/binary_container_1/BOOT.BIN root@&lt;zcu104 board ip&gt;:/mnt/sd-mmcblk0p1/
$ scp Vitis-AI/dsa/DPU-TRD/prj/Vitis/binary_container_1/dpu.xclbin root@&lt;zcu104 board ip&gt;:/mnt/sd-mmcblk0p1/

</pre></div>
</div>
<ol class="simple">
<li><p>Burn the SD card with the image generated in <em><strong>${Vitis-AI}/dsa/DPU-TRD/prj/Vitis/binary_container_1/sd_card.img</strong></em></p></li>
</ol>
</div>
</div>
<div class="section" id="step-3-cross-compiler-environtment-set-up-and-build-application">
<h2>Step 3: Cross Compiler Environtment Set up and Build application<a class="headerlink" href="#step-3-cross-compiler-environtment-set-up-and-build-application" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<ul class="simple">
<li><p>Install the SDK package and the Vitis AI cross compile package</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sh sdk-2020.2.0.0.sh
$tar -xvzf vitis_ai_2020.2-r1.3.0.tar.gz -C &lt;path-to-sysroot&gt;/
</pre></div>
</div>
<ul class="simple">
<li><p>After installing the sdk package, we use the script to set up the cross-compile environemnt by using the following commands.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ source &lt;full_path_of_sdk&gt;/environment-setup-aarch64-xilinx-linux
$ cd ${Section_3-Basic}/Module_7/
$ sh build_app_hls.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Copy the test yuv file to target.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ scp test.yuv root@&lt;zcu104 ip&gt;:/home/root
</pre></div>
</div>
<ul class="simple">
<li><p>Copy the library and the applications to target board</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
$ scp ${Module_7}/install/libhls_v4l2s.so root@Board_IP:/usr/lib
$ scp ${Module_7}/test/test_hls_kernel  root@Board_IP:/home/root
$ scp ${Module_7}/test/usb_input_multi_threads_refinedet_hls_drm  root@Board_IP:/home/root

</pre></div>
</div>
<div class="section" id="step-4-run-the-application-on-target">
<h3>Step 4: Run the Application on Target<a class="headerlink" href="#step-4-run-the-application-on-target" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Test the HLS kernel to see if it works properly with the test example. When the test example works, you will notice that two PNG files are generated in your execution directory.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># chmod +x test_hls_kernel</span>
<span class="c1"># ./test_hls_kernel</span>
</pre></div>
</div>
<ul class="simple">
<li><p>In this case we use refinedet model to show the body detecition.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">./</span><span class="n">usb_input_multi_threads_refinedet_hls_drm</span> <span class="n">refinedet_pruned_0_8</span> <span class="mi">0</span> <span class="o">-</span><span class="n">t</span> <span class="mi">3</span>
</pre></div>
</div>
<ul class="simple">
<li><p>DESCRIPTION</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">-</span> <span class="n">refinedet_pruned_0_8</span><span class="p">:</span> <span class="n">The</span> <span class="n">model</span> <span class="n">used</span><span class="p">;</span>
    <span class="o">-</span> <span class="mi">0</span>                   <span class="p">:</span>  <span class="n">Camera</span> <span class="nb">input</span><span class="p">;</span>
    <span class="o">-</span> <span class="o">-</span><span class="n">t</span> <span class="mi">3</span>                <span class="p">:</span>  <span class="n">thread</span> <span class="n">number</span> <span class="mi">3</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Optional</p></li>
</ul>
<p>If you are interested in the gap between hls kenel’s preprocessing performance and arm’s processing performance. You can also recompile the program to see the performance</p>
<ul class="simple">
<li><p>Build the application</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ build_app_arm.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Copy the library and the applications to target board</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
$ scp ${Module_7}/install/libhls_v4l2s.so root@Board_IP:/usr/lib
$ scp ${Module_7}/test/test_hls_kernel  root@Board_IP:/home/root
$ scp ${Module_7}/test/usb_input_multi_threads_refinedet_hls_drm  root@Board_IP:/home/root

</pre></div>
</div>
<p align="center"><sup>Copyright&copy; 2020 Xilinx</sup></p></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2020–2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>